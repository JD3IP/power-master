services:
  power-master:
    image: ghcr.io/jd3ip/power-master:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: power-master
    restart: unless-stopped

    # Host networking gives direct access to:
    #   - Inverter on LAN (Modbus TCP, default 192.168.1.100:502)
    #   - MQTT broker (default localhost:1883)
    # If you prefer bridge networking, comment out network_mode and
    # uncomment the ports section below.
    network_mode: host

    # ports:
    #   - "8080:8080"    # Dashboard
    #   - "1883:1883"    # MQTT (only if broker runs in this container)

    volumes:
      - power-master-data:/data
      - /var/run/docker.sock:/var/run/docker.sock:ro

    environment:
      - TZ=Australia/Brisbane

volumes:
  power-master-data:
